import{QueryClient as e,QueryObserver as t,InfiniteQueryObserver as r,MutationObserver as n}from"@tanstack/query-core";import{atom as s}from"jotai/vanilla";import{atom as o}from"jotai";import{make as u,pipe as i,toObservable as c}from"wonka";const p=s(new e);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}"production"!==process.env.NODE_ENV&&(p.debugPrivate=!0);const d=(e,t,r)=>(null==e?void 0:e.suspense)&&E(t,r),E=(e,t)=>e.isPending&&!t,v=({result:e,throwOnError:t,query:r})=>e.isError&&!e.isFetching&&g(t,[e.error,r]);function g(e,t){return"function"==typeof e?e(...t):!!e}function N(e,t,r=(e=>e(p))){const n=o(0);"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0);const s=o(e=>{const r=t(e),n=u(({next:e})=>r.subscribe(t=>{e(t)}));return i(n,c)});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);const a=o(e=>{const r=t(e),n=e(s),u=r.getCurrentResult(),i=o(u);return"production"!==process.env.NODE_ENV&&(i.debugPrivate=!0),i.onMount=e=>{const{unsubscribe:t}=n.subscribe(t=>{e(t)});return()=>t()},i});return"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0),o(s=>{const o=t(s),u=e(s),i=r(s);n.onMount=()=>()=>{o.getCurrentResult().isError&&i.resetQueries({queryKey:o.getCurrentQuery().queryKey})},s(n),s(s(a));const c=o.getOptimisticResult(u);if(d(u,c,!1))return o.fetchOptimistic(u);if(v({result:c,query:o.getCurrentQuery(),throwOnError:u.throwOnError}))throw c.error;return c})}function b(e,r=(e=>e(p))){const n=o(()=>new WeakMap);"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0);const s=o(t=>{const s=r(t),o=e(t),u=t(n).get(s),i=s.defaultQueryOptions(o);return i._optimisticResults="optimistic",u&&u.setOptions(i,{listeners:!1}),i});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);const u=o(e=>{const o=e(s),u=r(e),i=e(n),c=i.get(u);if(c)return c;const p=new t(u,o);return i.set(u,p),p});return"production"!==process.env.NODE_ENV&&(u.debugPrivate=!0),N(e=>a({},e(s),{suspense:!1}),e=>e(u),r)}const O=(e,r=(e=>e(p)))=>{const n=o(()=>new WeakMap);"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0);const s=o(t=>{const s=r(t),o=e(t),u=t(n).get(s),i=s.defaultQueryOptions(o);return i._optimisticResults="optimistic","number"!=typeof i.staleTime&&(i.staleTime=1e3),u&&u.setOptions(i,{listeners:!1}),i});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);const u=o(e=>{const o=e(s),u=r(e),i=e(n),c=i.get(u);if(c)return c;const p=new t(u,o);return i.set(u,p),p});return"production"!==process.env.NODE_ENV&&(u.debugPrivate=!0),N(e=>a({},e(s),{suspense:!0,enabled:!0}),e=>e(u),r)};function l(e,t=(e=>e(p))){const n=s(()=>new WeakMap);"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0);const o=s(r=>{const s=t(r),o=e(r),u=r(n).get(s),i=s.defaultQueryOptions(o);return i._optimisticResults="optimistic",u&&u.setOptions(i,{listeners:!1}),i});"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);const u=s(e=>{const s=e(o),u=t(e),i=e(n),c=i.get(u);if(c)return c;const p=new r(u,s);return i.set(u,p),p});return N(e=>a({},e(o),{suspense:!1}),e=>e(u),t)}function f(e,t=(e=>e(p))){const r=Symbol(),s=o(r=>{const n=t(r),s=e(r);return n.defaultMutationOptions(s)});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);const d=o(()=>new WeakMap);"production"!==process.env.NODE_ENV&&(d.debugPrivate=!0);const E=o(e=>{const o=e(s),u=t(e),i=e(d),c=i.get(u);if(c)return c[r]=!0,c.setOptions(o),delete c[r],c;const p=new n(u,o);return i.set(u,p),p});"production"!==process.env.NODE_ENV&&(E.debugPrivate=!0);const v=o(e=>{const t=e(E),n=u(({next:e})=>t.subscribe(n=>{const s=()=>e(n);t[r]?Promise.resolve().then(s):s()}));return i(n,c)}),N=o(e=>{const t=e(E),r=e(v),n=t.getCurrentResult(),s=o(n);return s.onMount=e=>(r.subscribe(t=>{e(t)}),()=>{t.reset()}),"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0),s}),b=o(e=>{const t=e(E);return(e,r)=>{t.mutate(e,r).catch(m)}});return"production"!==process.env.NODE_ENV&&(b.debugPrivate=!0),o(e=>{const t=e(E),r=e(N),n=e(r),s=e(b);if(n.isError&&g(t.options.throwOnError,[n.error]))throw n.error;return a({},n,{mutate:s,mutateAsync:n.mutate})})}function m(){}const _=(e,t=(e=>e(p)))=>{const n=o(()=>new WeakMap);"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0);const s=o(r=>{const s=t(r),o=e(r),u=r(n).get(s),i=s.defaultQueryOptions(o);return i._optimisticResults="optimistic","number"!=typeof i.staleTime&&(i.staleTime=1e3),u&&u.setOptions(i,{listeners:!1}),i});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);const u=o(e=>{const o=e(s),u=t(e),i=e(n),c=i.get(u);if(c)return c;const p=new r(u,o);return i.set(u,p),p});return"production"!==process.env.NODE_ENV&&(u.debugPrivate=!0),N(e=>a({},e(s),{suspense:!0,enabled:!0}),e=>e(u),t)},P=(e,t=(e=>e(p)))=>{const r=o([]);"production"!==process.env.NODE_ENV&&(r.debugPrivate=!0);const n=o(n=>{const s=t(n).getMutationCache();r.onMount=r=>{s.subscribe(()=>{r(function(e,t){return e.findAll(a({},t.filters,{status:"pending"})).map(e=>t.select?t.select(e):e.state)}(t(n).getMutationCache(),e(n)))})}});return"production"!==process.env.NODE_ENV&&(n.debugPrivate=!0),o(e=>(e(n),e(r)))};export{l as atomWithInfiniteQuery,f as atomWithMutation,P as atomWithMutationState,b as atomWithQuery,_ as atomWithSuspenseInfiniteQuery,O as atomWithSuspenseQuery,p as queryClientAtom};
//# sourceMappingURL=index.modern.mjs.map
