!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@tanstack/query-core"),require("jotai/vanilla"),require("jotai"),require("wonka")):"function"==typeof define&&define.amd?define(["exports","@tanstack/query-core","jotai/vanilla","jotai","wonka"],e):e((t||self).jotaiTanstackQuery={},t.queryCore,t.vanilla,t.jotai,t.wonka)}(this,function(t,e,r,n,o){var u=r.atom(new e.QueryClient);function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},i.apply(this,arguments)}function a(t,e){return"function"==typeof t?t.apply(void 0,e):!!t}function s(t,e,r){void 0===r&&(r=function(t){return t(u)});var i=n.atom(0);"production"!==process.env.NODE_ENV&&(i.debugPrivate=!0);var s=n.atom(function(t){var r=e(t),n=o.make(function(t){var e=t.next;return r.subscribe(function(t){e(t)})});return o.pipe(n,o.toObservable)});"production"!==process.env.NODE_ENV&&(s.debugPrivate=!0);var c=n.atom(function(t){var r=e(t),o=t(s),u=r.getCurrentResult(),i=n.atom(u);return"production"!==process.env.NODE_ENV&&(i.debugPrivate=!0),i.onMount=function(t){var e=o.subscribe(function(e){t(e)}).unsubscribe;return function(){return e()}},i});return"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0),n.atom(function(n){var o=e(n),u=t(n),s=r(n);i.onMount=function(){return function(){o.getCurrentResult().isError&&s.resetQueries({queryKey:o.getCurrentQuery().queryKey})}},n(i),n(n(c));var v=o.getOptimisticResult(u);if(function(t,e,r){return(null==t?void 0:t.suspense)&&function(t,e){return t.isPending&&!0}(e)}(u,v))return o.fetchOptimistic(u);if(function(t){var e=t.result;return e.isError&&!e.isFetching&&a(t.throwOnError,[e.error,t.query])}({result:v,query:o.getCurrentQuery(),throwOnError:u.throwOnError}))throw v.error;return v})}function c(){}"production"!==process.env.NODE_ENV&&(u.debugPrivate=!0),t.atomWithInfiniteQuery=function(t,n){void 0===n&&(n=function(t){return t(u)});var o=r.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);var a=r.atom(function(e){var r=n(e),u=t(e),i=e(o).get(r),a=r.defaultQueryOptions(u);return a._optimisticResults="optimistic",i&&i.setOptions(a,{listeners:!1}),a});"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var c=r.atom(function(t){var r=t(a),u=n(t),i=t(o),s=i.get(u);if(s)return s;var c=new e.InfiniteQueryObserver(u,r);return i.set(u,c),c});return s(function(t){return i({},t(a),{suspense:!1})},function(t){return t(c)},n)},t.atomWithMutation=function(t,r){void 0===r&&(r=function(t){return t(u)});var s=Symbol(),v=n.atom(function(e){var n=r(e),o=t(e);return n.defaultMutationOptions(o)});"production"!==process.env.NODE_ENV&&(v.debugPrivate=!0);var f=n.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(f.debugPrivate=!0);var p=n.atom(function(t){var n=t(v),o=r(t),u=t(f),i=u.get(o);if(i)return i[s]=!0,i.setOptions(n),delete i[s],i;var a=new e.MutationObserver(o,n);return u.set(o,a),a});"production"!==process.env.NODE_ENV&&(p.debugPrivate=!0);var d=n.atom(function(t){var e=t(p),r=o.make(function(t){var r=t.next;return e.subscribe(function(t){var n=function(){return r(t)};e[s]?Promise.resolve().then(n):n()})});return o.pipe(r,o.toObservable)}),m=n.atom(function(t){var e=t(p),r=t(d),o=e.getCurrentResult(),u=n.atom(o);return u.onMount=function(t){return r.subscribe(function(e){t(e)}),function(){e.reset()}},"production"!==process.env.NODE_ENV&&(u.debugPrivate=!0),u}),b=n.atom(function(t){var e=t(p);return function(t,r){e.mutate(t,r).catch(c)}});return"production"!==process.env.NODE_ENV&&(b.debugPrivate=!0),n.atom(function(t){var e=t(p),r=t(m),n=t(r),o=t(b);if(n.isError&&a(e.options.throwOnError,[n.error]))throw n.error;return i({},n,{mutate:o,mutateAsync:n.mutate})})},t.atomWithMutationState=function(t,e){void 0===e&&(e=function(t){return t(u)});var r=n.atom([]);"production"!==process.env.NODE_ENV&&(r.debugPrivate=!0);var o=n.atom(function(n){var o=e(n).getMutationCache();r.onMount=function(r){o.subscribe(function(){r(function(t,e){return t.findAll(i({},e.filters,{status:"pending"})).map(function(t){return e.select?e.select(t):t.state})}(e(n).getMutationCache(),t(n)))})}});return"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0),n.atom(function(t){return t(o),t(r)})},t.atomWithQuery=function(t,r){void 0===r&&(r=function(t){return t(u)});var o=n.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);var a=n.atom(function(e){var n=r(e),u=t(e),i=e(o).get(n),a=n.defaultQueryOptions(u);return a._optimisticResults="optimistic",i&&i.setOptions(a,{listeners:!1}),a});"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var c=n.atom(function(t){var n=t(a),u=r(t),i=t(o),s=i.get(u);if(s)return s;var c=new e.QueryObserver(u,n);return i.set(u,c),c});return"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0),s(function(t){return i({},t(a),{suspense:!1})},function(t){return t(c)},r)},t.atomWithSuspenseInfiniteQuery=function(t,r){void 0===r&&(r=function(t){return t(u)});var o=n.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);var a=n.atom(function(e){var n=r(e),u=t(e),i=e(o).get(n),a=n.defaultQueryOptions(u);return a._optimisticResults="optimistic","number"!=typeof a.staleTime&&(a.staleTime=1e3),i&&i.setOptions(a,{listeners:!1}),a});"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var c=n.atom(function(t){var n=t(a),u=r(t),i=t(o),s=i.get(u);if(s)return s;var c=new e.InfiniteQueryObserver(u,n);return i.set(u,c),c});return"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0),s(function(t){return i({},t(a),{suspense:!0,enabled:!0})},function(t){return t(c)},r)},t.atomWithSuspenseQuery=function(t,r){void 0===r&&(r=function(t){return t(u)});var o=n.atom(function(){return new WeakMap});"production"!==process.env.NODE_ENV&&(o.debugPrivate=!0);var a=n.atom(function(e){var n=r(e),u=t(e),i=e(o).get(n),a=n.defaultQueryOptions(u);return a._optimisticResults="optimistic","number"!=typeof a.staleTime&&(a.staleTime=1e3),i&&i.setOptions(a,{listeners:!1}),a});"production"!==process.env.NODE_ENV&&(a.debugPrivate=!0);var c=n.atom(function(t){var n=t(a),u=r(t),i=t(o),s=i.get(u);if(s)return s;var c=new e.QueryObserver(u,n);return i.set(u,c),c});return"production"!==process.env.NODE_ENV&&(c.debugPrivate=!0),s(function(t){return i({},t(a),{suspense:!0,enabled:!0})},function(t){return t(c)},r)},t.queryClientAtom=u});
//# sourceMappingURL=index.umd.js.map
